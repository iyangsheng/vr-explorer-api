流程：
![](https://cdn.nlark.com/yuque/__puml/042c72cf4cc58eb9819ea5ec459982e2.svg#lake_card_v2=eyJ0eXBlIjoicHVtbCIsImNvZGUiOiJAc3RhcnR1bWxcblxuYXV0b251bWJlclxuYWN0b3IgXCLnlKjmiLdcIiBhcyB1c2VyXG5wYXJ0aWNpcGFudCBcIuesrOS4ieaWueacjeWKoVwiICBhcyBPdGhlclNlcnZpY2VcbnBhcnRpY2lwYW50IFwi6K6-5aSH56uvXCIgIGFzIGRldmljZURcbnBhcnRpY2lwYW50IFwi5ZCO5Y-wXCIgYXMgQmFja1NlcnZpY2VcbnBhcnRpY2lwYW50IFwi57u05aGRQXBpXCIgYXMgV1NhcGlcblxuYWN0aXZhdGUgdXNlclxuICBkZXZpY2VELT5kZXZpY2VEOiDlvIDmnLpcbmFjdGl2YXRlIEJhY2tTZXJ2aWNlXG4gIEJhY2tTZXJ2aWNlLT5kZXZpY2VEOiDlkI7lj7DkuLvliqjmjqjpgIEg6L-b6KGM5bqP5YiX5Y-35bGV56S66L-Y5piv5LqM57u056CB5bGV56S655qE54q25oCBXG5kZWFjdGl2YXRlIEJhY2tTZXJ2aWNlXG5hbHRcbm5vdGUgcmlnaHQgb2YgZGV2aWNlRDog5LqM57u056CB5a-55o6lXG5hY3RpdmF0ZSBkZXZpY2VEXG5cdGRldmljZUQtPkJhY2tTZXJ2aWNlOiDnlKjmiLflvIDlp4vmtYvph4_or7fmsYLkuoznu7TnoIFcbmRlYWN0aXZhdGUgZGV2aWNlRFxuYWN0aXZhdGUgQmFja1NlcnZpY2VcbiBCYWNrU2VydmljZS0-T3RoZXJTZXJ2aWNlOiDojrflj5bkv6Hmga_lh63or4FcbmRlYWN0aXZhdGUgIEJhY2tTZXJ2aWNlXG5hY3RpdmF0ZSBPdGhlclNlcnZpY2Vcblx0IE90aGVyU2VydmljZS0-QmFja1NlcnZpY2U6IOi_lOWbnuWHreivgVxuZGVhY3RpdmF0ZSAgT3RoZXJTZXJ2aWNlXG5hY3RpdmF0ZSAgQmFja1NlcnZpY2Vcblx0QmFja1NlcnZpY2UtPk90aGVyU2VydmljZTog5pC65bimdG9rZW7or7fmsYLkuoznu7TnoIHmjqXlj6NcbmRlYWN0aXZhdGUgIEJhY2tTZXJ2aWNlXG5hY3RpdmF0ZSBPdGhlclNlcnZpY2Vcblx0T3RoZXJTZXJ2aWNlLT5CYWNrU2VydmljZTog6L-U5Zue5LqM57u056CBXG5kZWFjdGl2YXRlIE90aGVyU2VydmljZVxuYWN0aXZhdGUgIEJhY2tTZXJ2aWNlXG5cdEJhY2tTZXJ2aWNlLT5kZXZpY2VEOiDov5Tlm57kuoznu7TnoIFcbmRlYWN0aXZhdGUgQmFja1NlcnZpY2VcbmVuZFxuXHR1c2VyLT5PdGhlclNlcnZpY2U6IOaJq-eggVxuYWN0aXZhdGUgT3RoZXJTZXJ2aWNlXG5cdE90aGVyU2VydmljZS0-V1NhcGk6IOeUqOaIt-S_oeaBr-e7keWumlxuYWN0aXZhdGUgV1NhcGlcblx0V1NhcGktPk90aGVyU2VydmljZTog5L-h5oGv57uR5a6a5oiQ5YqfXG5kZWFjdGl2YXRlIE90aGVyU2VydmljZVxuXHRXU2FwaS0-QmFja1NlcnZpY2U6IOWPkei1t-WQiOaIkFxuZGVhY3RpdmF0ZSBXU2FwaVxuYWN0aXZhdGUgQmFja1NlcnZpY2Vcblx0QmFja1NlcnZpY2UtPmRldmljZUQ6IOWFs-mXreS6jOe7tOeggVxuXG5cdEJhY2tTZXJ2aWNlLT5PdGhlclNlcnZpY2U6IOaVsOaNruWQiOaIkOaIkOWKn1xuXG5kZWFjdGl2YXRlIEJhY2tTZXJ2aWNlXG5hY3RpdmF0ZSBPdGhlclNlcnZpY2Vcblx0T3RoZXJTZXJ2aWNlLT5XU2FwaTog6I635Y-W5omr5o-P5pWw5o2uXG5hY3RpdmF0ZSBXU2FwaVxuXHRPdGhlclNlcnZpY2UtPnVzZXI6IOeVjOmdouWxleekulxuXHRXU2FwaS0-T3RoZXJTZXJ2aWNlOiDov5Tlm57miavmj4_mlbDmja5cbmRlYWN0aXZhdGUgT3RoZXJTZXJ2aWNlXG5kZWFjdGl2YXRlIFdTYXBpXG5cbmRlYWN0aXZhdGUgdXNlclxuXG5AZW5kdW1sICIsInVybCI6Imh0dHBzOi8vY2RuLm5sYXJrLmNvbS95dXF1ZS9fX3B1bWwvMDQyYzcyY2Y0Y2M1OGViOTgxOWVhNWVjNDU5OTgyZTIuc3ZnIiwiaWQiOiJHVEJZUiIsIm1hcmdpbiI6eyJ0b3AiOnRydWUsImJvdHRvbSI6dHJ1ZX0sImNhcmQiOiJkaWFncmFtIn0=)**设备端交互效果图：**
![image.png](https://cdn.nlark.com/yuque/0/2021/png/21651137/1629109459661-5645bd73-fa96-4c1f-aea9-c1aa76146b26.png#clientId=ua1ed334e-95c0-4&from=paste&height=191&id=u57c271dd&margin=%5Bobject%20Object%5D&name=image.png&originHeight=381&originWidth=224&originalType=binary&ratio=1&size=39105&status=done&style=none&taskId=u6d5fa7b0-9119-4d04-9874-0660661cdb3&width=112)
![image.png](https://cdn.nlark.com/yuque/0/2021/png/21651137/1629109528508-4b865959-2765-48be-b752-51480e4caefd.png#clientId=ua1ed334e-95c0-4&from=paste&height=191&id=u0b1e5039&margin=%5Bobject%20Object%5D&name=image.png&originHeight=382&originWidth=212&originalType=binary&ratio=1&size=24373&status=done&style=none&taskId=u38cf1cf6-c6bf-4af4-b15b-712fc23abbb&width=106)​
**规则：**

- 测量报告完成 页面倒计时 120 秒，120 秒后若未扫码则返回待机页；
- 若收到用户信息绑定，视为扫码成功，关闭二维码，反馈扫码成功

**B 端：** 1.客户具有 api 权限时：
![image.png](https://cdn.nlark.com/yuque/0/2021/png/21651137/1629264970894-8480816d-4d09-4f71-8faa-e1f4e6c67c4e.png#clientId=uc64b746b-69cc-4&from=paste&height=328&id=uf98fc73b&margin=%5Bobject%20Object%5D&name=image.png&originHeight=656&originWidth=1150&originalType=binary&ratio=1&size=104180&status=done&style=none&taskId=u986681ab-896b-4ccc-a211-7d2a47434b6&width=575)**图一**
![image.png](https://cdn.nlark.com/yuque/0/2021/png/21651137/1629265010536-3b30ab6b-d746-4f42-bc8b-765e0813de1a.png#clientId=uc64b746b-69cc-4&from=paste&height=324&id=u61f8148b&margin=%5Bobject%20Object%5D&name=image.png&originHeight=648&originWidth=1151&originalType=binary&ratio=1&size=81638&status=done&style=none&taskId=u8181313d-d356-43a0-8cd5-0d01c0291f2&width=575.5)**图 二**

- **展示该对接页面如上图一**
- **进入 api 对接后，可进行 api 接口配置 需配置的接口如 图 二**

         规则：

  - 维塑向第三方服务获取接口凭证 token 的地址、key 和 Secret，设置时请将 key 和 Secret 包含在地址中
  - 维塑云端体测/体态数据计算出来之后，调用此接口通知第三方。收到合成通知后，第三方云可调用相应数据
  - 维塑二维码请求地址（可填 可不填）
  - 点击确认按钮可以获取到 VFID， VFSECRET 字段

- **展示对接文档： 超链接方式**
- **设置了二维码对接后，dashboard 的默认页面改为报告列表，隐藏用户信息绑定页面（原默认页面是用户信息绑定页面）**
- **findUserInfo**​

配置完成接口返回：

- **findDeviceTypeInfo**

```
{
    code: 200
    data: {
      accessKey: "aaa"
      accessSecret: "bbb"
      appId: ""
      appName: null
      appSecret: null
      appType: 1
      dockingApi: 1
      dockingApp: 1
      dockingCard: 1
      dockingWechat: 0
      id: 267
      jumpLink: ""
      mpUrl: null
      qrcode: null
      synBodyInfoUrl: "http://121.36.23.68:9876/vfair/notify"
      tokenUrl: "http://121.36.23.68:9876/vfair/token"
      userinfoUrl: ""
    }
    message: "获取成功"
}
```

** 新增接口文档：**

- **系统对接--API 对接文档：**[**http://192.168.2.117:4999/web/#/13?page_id=119**](http://192.168.2.117:4999/web/#/13?page_id=119)

**​**

**​**

**后台**

#### API 对接

1、需要确保提供的模型正确，能够通过 api 接口获取到模型文件
2、身体分数等信息通过调用第三方接口推送给客户。

#### 二维码对接

1、二维码对接（管理界面配置好二维码地址，在数据库中修改 docking_app 字段）
2、控制服务通过获取设备信息确定第三方对接方式通知前端（设备），设备端（前端）向状态通知服务请求二维码，状态通知服务会调用第三方二维码接口，获取二维码信息，并将二维码返回给设备端（前端）。
3、用户扫描二维码，绑定用户信息后。维塑的 api 服务会调用设备端的状态通知服务提供的 Http 接口，TaskManager 服务会调用第三方的合成通知接口。推送合成信息。
